import{_ as O,u as P,r as d,o as $,m as A,a as G,b as h,c as H,d as V,e as z,f as l,g as J,w as a,h as c,t as f,i as p,F as N,j as K,k as Q,l as W,E as X,n as Z,p as ee,q as te,s as le,v as oe}from"./index-BTl7R4UL.js";import{E as ae}from"./el-overlay-CDgHjuIW.js";import{E as ne,a as se,b as ie,c as re,d as ue,e as de}from"./el-table-column-BbWqOXkO.js";import{d as pe}from"./dayjs.min-CxMP4GVf.js";const me={class:"flex-box"},_e={style:{"margin-left":"10px"}},ce={class:"pagination-info"},fe={class:"dialog-footer"},ge={__name:"index",setup(be){const C=P();console.log(C);const r=d({pageNum:1,pageSize:10}),u=d({list:[],total:0});$(()=>{m(),A().then(({data:o})=>{g.value=o.data})});const m=()=>{G(r.value).then(({data:o})=>{const{list:e,total:i}=o.data;e.forEach(n=>{n.create_time=pe(n.create_time).format("YYYY-MM-DD")}),u.value.list=e,u.value.total=i})},g=d([]),S=o=>{const e=g.value.find(i=>i.id===o);return e?e.name:"未找到权限"},U=o=>{_.value=!0,Object.assign(s,{mobile:o.mobile,name:o.name,permissions_id:o.permissions_id})},B=o=>{r.value.pageSize=o,m()},D=o=>{r.value.pageNum=o,m()},_=d(!1),x=()=>{_.value=!1,m(),b.value.resetFields()},b=d(),s=h({name:"",permissions_id:""}),F=async o=>{o&&await o.validate(async(e,i)=>{if(e){const{name:n,permissions_id:v}=s;Q({name:n,permissions_id:v}).then(({data:E})=>{E.code===1e4&&x()})}else console.log("error submit!",i)})},I=h({name:[{required:!0,message:"请填写昵称",trigger:"blur"}],permissions_id:[{required:!0,message:"请选择菜单权限",trigger:"blur"}]});return(o,e)=>{const i=W,n=ne,v=se,E=H("Clock"),T=X,k=Z,Y=ie,j=re,w=ee,y=te,q=de,M=ue,R=le,L=ae;return V(),z(N,null,[l(i,{route:J(C)},null,8,["route"]),l(Y,{data:u.value.list,style:{width:"100%"}},{default:a(()=>[l(n,{prop:"id",label:"id"}),l(n,{prop:"name",label:"昵称"}),l(n,{prop:"permissions_id",label:"所属组别"},{default:a(t=>[c(f(S(t.row.permissions_id)),1)]),_:1}),l(n,{prop:"mobile",label:"手机号"}),l(n,{prop:"active",label:"状态"},{default:a(t=>[l(v,{type:t.row.active?"success":"danger"},{default:a(()=>[c(f(t.row.active?"正常":"失效"),1)]),_:2},1032,["type"])]),_:1}),l(n,{prop:"active",label:"创建时间"},{default:a(t=>[p("div",me,[l(T,null,{default:a(()=>[l(E)]),_:1}),p("span",_e,f(t.row.create_time),1)])]),_:1}),l(n,{label:"操作"},{default:a(t=>[l(k,{type:"primary",onClick:ve=>U(t.row)},{default:a(()=>e[6]||(e[6]=[c("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),p("div",ce,[l(j,{"current-page":r.value.pageNum,"onUpdate:currentPage":e[0]||(e[0]=t=>r.value.pageNum=t),"page-size":r.value.pageSize,size:"small",background:!1,layout:"slot, prev, pager, next",total:u.value.total,onSizeChange:B,onCurrentChange:D},{default:a(()=>[p("span",null,"总页数："+f(u.value.total),1)]),_:1},8,["current-page","page-size","total"])]),l(L,{modelValue:_.value,"onUpdate:modelValue":e[5]||(e[5]=t=>_.value=t),"before-close":x,title:"添加权限",width:"500"},{footer:a(()=>[p("div",fe,[l(k,{type:"primary",onClick:e[4]||(e[4]=t=>F(b.value))},{default:a(()=>e[7]||(e[7]=[c("确认")])),_:1})])]),default:a(()=>[l(R,{ref_key:"fromRef",ref:b,"label-width":"100px","label-position":"left",model:s,rules:I},{default:a(()=>[l(y,{label:"手机号",prop:"mobile"},{default:a(()=>[l(w,{modelValue:s.mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>s.mobile=t),disabled:""},null,8,["modelValue"])]),_:1}),l(y,{label:"昵称",prop:"name"},{default:a(()=>[l(w,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=t=>s.name=t)},null,8,["modelValue"])]),_:1}),l(y,{label:"菜单权限",prop:"permissions_id"},{default:a(()=>[l(M,{modelValue:s.permissions_id,"onUpdate:modelValue":e[3]||(e[3]=t=>s.permissions_id=t),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:a(()=>[(V(!0),z(N,null,K(g.value,t=>(V(),oe(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},xe=O(ge,[["__scopeId","data-v-41b6dc45"]]);export{xe as default};
